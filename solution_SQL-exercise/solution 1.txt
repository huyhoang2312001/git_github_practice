select a.hacker_id, a.name
from(
    select d.hacker_id, d.name, count(*) num_full_scores
from submissions a
inner join challenges b on a.challenge_id = b.challenge_id 
inner join difficulty c on b.difficulty_level = c.difficulty_level
inner join hackers d on a.hacker_id=d.hacker_id 
where a.score = c.score
group by d.hacker_id, d.name
having count(1) >1
) a

order by a.num_full_scores desc, a.hacker_id ;